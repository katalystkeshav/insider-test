
# =============================================================================
# Dockerfile for nodejs app
# =============================================================================

FROM node:alpine
MAINTAINER Keshav Thakur

# ----------------------------------------------------------------------------- 
# Create new user and group
# ------------------------------------------------------------------------------

RUN adduser -D -g 'alpine' alpine

# ----------------------------------------------------------------------------- 
# Install 
# ----------------------------------------------------------------------------- 
  
# ----------------------------------------------------------------------------- 
# Copy content 
# ----------------------------------------------------------------------------- 

RUN mkdir /opt/test/
COPY . /opt/test/

# ----------------------------------------------------------------------------- 
# Change owner and permission
# ----------------------------------------------------------------------------- 

RUN chown -R alpine:alpine /opt/test/
 
# ----------------------------------------------------------------------------- 
# Switch user
# ----------------------------------------------------------------------------- 

USER alpine
WORKDIR /opt/test/

# ----------------------------------------------------------------------------- 
# Remove extra files 
# ----------------------------------------------------------------------------- 

RUN rm Dockerfile

# ----------------------------------------------------------------------------- 
# Set ports 
# ----------------------------------------------------------------------------- 

EXPOSE 3000
CMD node index.js